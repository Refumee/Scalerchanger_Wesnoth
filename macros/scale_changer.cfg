[modification]
    id=scalechanger
    name= _ "Saurian Scale Color Changer"
    type=hybrid

    description=_"Random Scale changing of all recruited Saurians"
    [options]
        [checkbox]
            id=scalechanger_ingame
            name=_"Allow Scale changing in a running game (own side)"
            description=_"Gives the player the option to change the scale color of a saurian of choice."
            default=no
        [/checkbox]
        [checkbox]
            id=scalechanger_ingame_allsides
            name=_"Allow Scale changing in a running game (all sides)"
            description=_"Gives the player the option to change the scale color of all saurian on the field."
            default=no
        [/checkbox]
        [checkbox]
            id=scalechanger_ingame_side
            name=_"Allow Scale changing of a whole side (own side)"
            description=_"Gives the player the option to change the scale color of a all his saurians."
            default=no
        [/checkbox]
        [checkbox]
            id=scalechanger_ingame_side_allsides
            name=_"Allow Scale changing of a whole side (all sides)"
            description=_"Gives the player the option to change the scale color of all saurian on any side."
            default=no
        [/checkbox]
    [/options]


### green palette vs new palette
#define SCALECHANGER_SCALE SCALECOLOR
{SCALE_GREEN} > {SCALECOLOR}#enddef


#define SCALECHANGER_CODE SCALEGOAL
		[object]
			scale_color_shift=yes
			silent=yes
			
			[filter]
				find_in=unit
				x,y=$x1,$y1
			[/filter]
			
			[effect]
				apply_to=image_mod
				add=PAL({SCALECHANGER_SCALE {SCALEGOAL}})
			[/effect]
		[/object]
#enddef

#define SCALECHANGER_CODE_SIDE SCALEGOAL SIDE
		[object]
			scale_color_shift=yes
			silent=yes
			
			[filter]
				find_in=unit
				x,y=$x1,$y1
				side={SIDE}
			[/filter]
			
			[effect]
				apply_to=image_mod
				add=PAL({SCALECHANGER_SCALE {SCALEGOAL}})
			[/effect]
		[/object]
#enddef

### making separate macro to make it possible to add modification options later
#define SCALECHANGER_MASTER
    [event]
        name=unit placed
        first_time_only=no

        [filter]
            race=lizard,black-marshes-saurians,bitter-swamp-lizard,thief-lizard #saurian pack compatibility
            [not]
                [filter_wml]
                    [modifications]
                        [object]
                            scale_color_shift=yes
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/not]
			[not]
				{VARIABLE_CONDITIONAL scalechanger_ingame_side equals yes}
			[/not]
			[not]
				{VARIABLE_CONDITIONAL scalechanger_ingame_side_allsides equals yes}
			[/not]
        [/filter]
		{RANDOM 1..10}
		[if]
            [variable]
                name=random
                numerical_equals=1
            [/variable]
		    [then]### Green default saurian
				{SCALECHANGER_CODE {SCALE_GREEN}} #needs to be done, so that if we recall the unit, it stays green
            [/then]
			[elseif] ### Moss saurian scales
				[variable]
					name=random
					numerical_equals=2
				[/variable]
				[then]
					{SCALECHANGER_CODE {SCALE_SHIFT_MOSS}}
				[/then]
			[/elseif]
			[elseif] ### Old color scheme saurian scales
				[variable]
					name=random
					numerical_equals=3
				[/variable]
				[then]
					{SCALECHANGER_CODE {SCALE_OLDGREEN}}
				[/then]
			[/elseif]
			[elseif] ### Old color scheme of oracle saurian scales
				[variable]
					name=random
					numerical_equals=4
				[/variable]
				[then]
					{SCALECHANGER_CODE {SCALE_OLDGREENORACLE}}
				[/then]
			[/elseif]
			[elseif] ### SCXRPG saurian scales
				[variable]
					name=random
					numerical_equals=5
				[/variable]
				[then]
					{SCALECHANGER_CODE {SCALE_SXRPGGREEN}}
				[/then]
			[/elseif]
			[elseif] ### Elvish fighter saurian scales
				[variable]
					name=random
					numerical_equals=6
				[/variable]
				[then]
					{SCALECHANGER_CODE {SCALE_ELVISHFIGHTERGREEN}}
				[/then]
			[/elseif]
			[elseif] ### Elvish scout saurian scales
				[variable]
					name=random
					numerical_equals=7
				[/variable]
				[then]
					{SCALECHANGER_CODE {SCALE_ELVISHSCOUTGREEN}}
				[/then]
			[/elseif]
			[elseif] ### Wose leaf saurian scales
				[variable]
					name=random
					numerical_equals=8
				[/variable]
				[then]
					{SCALECHANGER_CODE {SCALE_WOSEGREEN}}
				[/then]
			[/elseif]
			[elseif] ### Merfolk beard saurian scales
				[variable]
					name=random
					numerical_equals=9
				[/variable]
				[then]
					{SCALECHANGER_CODE {SCALE_MERFOLKGREEN}}
				[/then]
			[/elseif]
			[elseif] ### Drake green saurian scales
				[variable]
					name=random
					numerical_equals=10
				[/variable]
				[then]
					{SCALECHANGER_CODE {SCALE_DRAKEGREEN}}
				[/then]
			[/elseif]
		[/if]
    [/event]
#enddef

#define SCALECHANGER_MASTER_SIDE
    [event]
		name=start
        [if]
            [variable]
                name=scalechanger_ingame_side_allsides
                boolean_equals=yes
            [/variable]
			[then]
				[set_menu_item]
					id=colorchange_click_side
					description=_"Scale side color changer"
					[show_if]
						{VARIABLE_CONDITIONAL scalechanger_ingame_side_allsides equals yes}
					[/show_if]
					[filter_location]
						[filter]
							race=lizard,black-marshes-saurians,bitter-swamp-lizard,thief-lizard
							x,y=$x1,$y1
						[/filter]
					[/filter_location]
					[command]
						[clear_variable]
							name=saurian_location
						[/clear_variable]
						[store_unit]
							variable=saurian_location
							[filter]
								x,y=$x1,$y1
							[/filter]
						[/store_unit]
						[fire_event]
							id=changer_side
						[/fire_event]
					[/command]
				[/set_menu_item]
			[/then]
            [elseif]
				[variable]
					name=scalechanger_ingame_side
					boolean_equals=yes
				[/variable]
				[then]
					[set_menu_item]
						id=colorchange_click_side
						description=_"Scale side color changer"
						[show_if]
							{VARIABLE_CONDITIONAL scalechanger_ingame_side equals yes}
						[/show_if]
						[filter_location]
							[filter]
								side=$side_number
								race=lizard,black-marshes-saurians,bitter-swamp-lizard,thief-lizard
								x,y=$x1,$y1
							[/filter]
						[/filter_location]
						[command]
							[clear_variable]
								name=saurian_location
							[/clear_variable]
							[store_unit]
								variable=saurian_location
								[filter]
									x,y=$x1,$y1
								[/filter]
							[/store_unit]
							[fire_event]
								id=changer_side
							[/fire_event]
						[/command]
					[/set_menu_item]
				[/then]
			[/elseif]
		[/if]
	[/event]
	{COLORCHANGE_CLICK_EVENT_SIDE}
#enddef

	### menu item event ###
#define SCALECHANGER_CHANGER_CODE SCALEGOAL
		[object]
			scale_color_shift=yes
			silent=yes
			
				[filter]
					x,y=$saurian_location[0].x,$saurian_location[0].y
				[/filter]
			
			[effect]
				apply_to=image_mod
				replace=PAL({SCALECHANGER_SCALE {SCALEGOAL}})
			[/effect]
		[/object]
#enddef

#define SCALECHANGER_CHANGER_CODE_SIDE SCALEGOAL
		[modify_unit]
			[filter]
				side=$saurian_location[0].side
			[/filter]
			[modifications]
				scale_color_shift=yes
				silent=yes
				[object]
					[effect]
						apply_to=image_mod
						replace=PAL({SCALECHANGER_SCALE {SCALEGOAL}})
					[/effect]
				[/object]
			[/modifications]
		[/modify_unit]
#enddef

#define SCALECHANGER_RECRUIT_SIDE_CHANGER
    [event]
        name=unit placed
        first_time_only=no

        [filter]
            race=lizard,black-marshes-saurians,bitter-swamp-lizard,thief-lizard #saurian pack compatibility
            [not]
                [filter_wml]
                    [modifications]
                        [object]
                            scale_color_shift=yes
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/not]
			{VARIABLE_CONDITIONAL scalechanger_sides_active equals yes}
        [/filter]
		[for]
			array=scalecolor_side
			[do]
				{SCALECHANGER_CODE_SIDE $scalecolor_side[$i].value $scalecolor_side[$i].side}
			[/do]
		[/for]	

				#{SCALECHANGER_CODE_SIDE $scalecolor_side.value $scalecolor_side.side}

		
		#{SCALECHANGER_CODE_SIDE $scalecolor_scalegoal $scalecolor_side}
    [/event]
#enddef

#define COMMAND_FOR_COLORCHANGE_CLICK TEXT SCALEGOAL
    [option]
        image="data/core/images/units/saurians/skirmisher/skirmisher.png~" + PAL({SCALECHANGER_SCALE {SCALEGOAL}})
        description={TEXT}
        [command]
			{SCALECHANGER_CHANGER_CODE {SCALEGOAL}}
        [/command]
    [/option]
#enddef

#define COMMAND_FOR_COLORCHANGE_CLICK_SIDE TEXT SCALEGOAL
    [option]
        image="data/core/images/units/saurians/skirmisher/skirmisher.png~" + PAL({SCALECHANGER_SCALE {SCALEGOAL}})
        description={TEXT}
        [command]
			{SCALECHANGER_CHANGER_CODE_SIDE {SCALEGOAL}}
			[set_variable]
				name=scalechanger_sides_active
				value=yes
			[/set_variable]
			[set_variable]
				name=scalecolor_side[$saurian_location[0].side].value
				value={SCALEGOAL}
			[/set_variable]
			[set_variable]
				name=scalecolor_side[$saurian_location[0].side].side
				value=$saurian_location[0].side
			[/set_variable]
        [/command]
    [/option]
#enddef

#define SCALE_OPTION LABEL DESC IMG SCALEGOAL EVENT
	[option]
		label={LABEL}
		description={DESC}
		image={IMG} + PAL({SCALECHANGER_SCALE {SCALEGOAL}})
		[command]
			[fire_event]
				id={EVENT}
			[/fire_event]
		[/command]
	[/option]
#enddef

#define COLORCHANGE_CLICK_EVENT
	[event]
		name=changer
		id=changer
		first_time_only=no
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
			{COMMAND_FOR_COLORCHANGE_CLICK (_"Default green") {SCALE_GREEN}} 

			{COMMAND_FOR_COLORCHANGE_CLICK (_"1.16 Saurian green"){SCALE_OLDGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"1.16 Oracle Saurian") {SCALE_OLDGREENORACLE}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"SXRPG green Saurian") {SCALE_SXRPGGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Elfish fighter Saurian") {SCALE_ELVISHFIGHTERGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Elvish scout Saurian"){SCALE_ELVISHSCOUTGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Naga Saurian") {SCALE_NAGAGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Wose leaf Saurian") {SCALE_WOSEGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Merfolk beard Saurian") {SCALE_MERFOLKGREEN}}
			
			{COMMAND_FOR_COLORCHANGE_CLICK (_"Drake green Saurian") {SCALE_DRAKEGREEN}}
			
			{SCALE_OPTION (_ "More options:") (_ "Campaign Saurian scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_DEEP}
			(vpscale)}
			
			{SCALE_OPTION (_ "More options:") (_ "Spooky undead scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_PUMKIN}
			(undeadscale)}
			
			{SCALE_OPTION (_ "More options:") (_ "Experimental scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_MERFOLK}
			(experimentalscale)}
			[option]
                label= _ "Back to the game"
				[clear_variable]
					name=saurian_location
				[/clear_variable]
            [/option]
        [/message]
	[/event]
	[event]
		name=vpscale
		id=vpscale
		first_time_only=no
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
			{COMMAND_FOR_COLORCHANGE_CLICK (_"Deep Saurian"){SCALE_DEEP}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Desert Saurian") {SCALE_SHIFT_DESERT}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Chillwind Saurian") {SCALE_SHIFT_CHILLWIND}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Red Saurian") {SCALE_SHIFT_RED}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Salamander Saurian"){SCALE_SHIFT_SALAMANDER}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Rootless Saurian") {SCALE_SHIFT_ROOTLESS}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Greygreen Saurian") {SCALE_SHIFT_GREYGREEN}}

			{SCALE_OPTION (_ "Original List:") (_ "Original scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_GREEN}
			(changer)}
			
			{SCALE_OPTION (_ "More options:") (_ "Spooky undead scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_PUMKIN}
			(undeadscale)}
			
			{SCALE_OPTION (_ "More options:") (_ "Experimental scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_MERFOLK}
			(experimentalscale)}
			[option]
                label= _ "Back to the game"
				[clear_variable]
					name=saurian_location
				[/clear_variable]
            [/option]
        [/message]
	[/event]
	[event]
		name=undeadscale
		id=undeadscale
		first_time_only=no
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
			{COMMAND_FOR_COLORCHANGE_CLICK (_"Walking Corpse Saurian") {SCALE_SHIFT_WC}} 

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Soulless Saurian"){SCALE_SHIFT_SOUL}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Vendraxis' Lich Saurian") {SCALE_SHIFT_VP}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Skeleton Saurian") {SCALE_SHIFT_SKELETON}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Pumpkin Saurian") {SCALE_SHIFT_PUMKIN}}
			
			{COMMAND_FOR_COLORCHANGE_CLICK (_"Dark Saurian") {SCALE_SHIFT_DARKGREY}}
			
			{COMMAND_FOR_COLORCHANGE_CLICK (_"TC Saurian") {SCALE_SHIFT_TEAMCOLOR}}

			{SCALE_OPTION (_ "Original List:") (_ "Original scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_GREEN}
			(changer)}
			
			{SCALE_OPTION (_ "More options:") (_ "Campaign Saurian scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_DEEP}
			(vpscale)}
			
			{SCALE_OPTION (_ "More options:") (_ "Experimental scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_MERFOLK}
			(experimentalscale)}
			[option]
                label= _ "Back to the game"
				[clear_variable]
					name=saurian_location
				[/clear_variable]
            [/option]
        [/message]
	[/event]
	[event]
		name=experimentalscale
		id=experimentalscale
		first_time_only=no
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
			{COMMAND_FOR_COLORCHANGE_CLICK (_"Drake Burner Saurian") {SCALE_SHIFT_DRAKEBURNER}} 

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Dunestrider Saurian"){SCALE_SHIFT_DUNESTRIDER}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Loyalist Armor Saurian") {SCALE_SHIFT_LOYALISTKNIGHT}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Outlaw Assassin Saurian") {SCALE_SHIFT_OUTLAWASSASSIN}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Merfolk Saurian") {SCALE_SHIFT_MERFOLK}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Orcish Armor Saurian"){SCALE_SHIFT_ORCISHARMOR}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Wose Wood Saurian") {SCALE_SHIFT_WOSEWOODEN}}
			
			{COMMAND_FOR_COLORCHANGE_CLICK (_"Purple Saurian") {SCALE_SHIFT_PURPLE}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"The Golden Saurian") {SCALE_SHIFT_GOLDEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK (_"Dark purple Saurian"){SCALE_SHIFT_DARKPURPLE}}
			
			{SCALE_OPTION (_ "Original List:") (_ "Original scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_GREEN}
			(changer)}
			
			{SCALE_OPTION (_ "More options:") (_ "Campaign Saurian scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_DEEP}
			(vpscale)}
			
			{SCALE_OPTION (_ "More options:") (_ "Spooky undead scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_PUMKIN}
			(undeadscale)}
			[option]
                label= _ "Back to the game"
				[clear_variable]
					name=saurian_location
				[/clear_variable]
            [/option]
        [/message]
	[/event]
#enddef

#define COLORCHANGE_CLICK_EVENT_SIDE
	[event]
		name=changer_side
		id=changer_side
		first_time_only=no
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Default green") {SCALE_GREEN}} 

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"1.16 Saurian green"){SCALE_OLDGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"1.16 Oracle Saurian") {SCALE_OLDGREENORACLE}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"SXRPG green Saurian") {SCALE_SXRPGGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Elfish fighter Saurian") {SCALE_ELVISHFIGHTERGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Elvish scout Saurian"){SCALE_ELVISHSCOUTGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Naga Saurian") {SCALE_NAGAGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Wose leaf Saurian") {SCALE_WOSEGREEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Merfolk beard Saurian") {SCALE_MERFOLKGREEN}}
			
			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Drake green Saurian") {SCALE_DRAKEGREEN}}
			
			{SCALE_OPTION (_ "More options:") (_ "Campaign Saurian scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_DEEP}
			(vpscale_side)}
			
			{SCALE_OPTION (_ "More options:") (_ "Spooky undead scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_PUMKIN}
			(undeadscale_side)}
			
			{SCALE_OPTION (_ "More options:") (_ "Experimental scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_MERFOLK}
			(experimentalscale_side)}
			[option]
                label= _ "Back to the game"
				[clear_variable]
					name=saurian_location
				[/clear_variable]
            [/option]
        [/message]
	[/event]
	[event]
		name=vpscale_side
		id=vpscale_side
		first_time_only=no
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Deep Saurian"){SCALE_DEEP}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Desert Saurian") {SCALE_SHIFT_DESERT}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Chillwind Saurian") {SCALE_SHIFT_CHILLWIND}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Red Saurian") {SCALE_SHIFT_RED}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Salamander Saurian"){SCALE_SHIFT_SALAMANDER}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Rootless Saurian") {SCALE_SHIFT_ROOTLESS}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Greygreen Saurian") {SCALE_SHIFT_GREYGREEN}}

			{SCALE_OPTION (_ "Original List:") (_ "Original scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_GREEN}
			(changer_side_side)}
			
			{SCALE_OPTION (_ "More options:") (_ "Spooky undead scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_PUMKIN}
			(undeadscale_side)}
			
			{SCALE_OPTION (_ "More options:") (_ "Experimental scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_MERFOLK}
			(experimentalscale_side)}
			[option]
                label= _ "Back to the game"
				[clear_variable]
					name=saurian_location
				[/clear_variable]
            [/option]
        [/message]
	[/event]
	[event]
		name=undeadscale_side
		id=undeadscale_side
		first_time_only=no
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Walking Corpse Saurian") {SCALE_SHIFT_WC}} 

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Soulless Saurian"){SCALE_SHIFT_SOUL}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Vendraxis' Lich Saurian") {SCALE_SHIFT_VP}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Skeleton Saurian") {SCALE_SHIFT_SKELETON}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Pumpkin Saurian") {SCALE_SHIFT_PUMKIN}}
			
			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Dark Saurian") {SCALE_SHIFT_DARKGREY}}
			
			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"TC Saurian") {SCALE_SHIFT_TEAMCOLOR}}

			{SCALE_OPTION (_ "Original List:") (_ "Original scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_GREEN}
			(changer_side)}
			
			{SCALE_OPTION (_ "More options:") (_ "Campaign Saurian scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_DEEP}
			(vpscale_side)}
			
			{SCALE_OPTION (_ "More options:") (_ "Experimental scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_MERFOLK}
			(experimentalscale_side)}
			[option]
                label= _ "Back to the game"
				[clear_variable]
					name=saurian_location
				[/clear_variable]
            [/option]
        [/message]
	[/event]
	[event]
		name=experimentalscale_side
		id=experimentalscale_side
		first_time_only=no
		
		[message]
            speaker=narrator
			image=wesnoth-icon.png
			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Drake Burner Saurian") {SCALE_SHIFT_DRAKEBURNER}} 

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Dunestrider Saurian"){SCALE_SHIFT_DUNESTRIDER}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Loyalist Armor Saurian") {SCALE_SHIFT_LOYALISTKNIGHT}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Outlaw Assassin Saurian") {SCALE_SHIFT_OUTLAWASSASSIN}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Merfolk Saurian") {SCALE_SHIFT_MERFOLK}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Orcish Armor Saurian"){SCALE_SHIFT_ORCISHARMOR}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Wose Wood Saurian") {SCALE_SHIFT_WOSEWOODEN}}
			
			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Purple Saurian") {SCALE_SHIFT_PURPLE}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"The Golden Saurian") {SCALE_SHIFT_GOLDEN}}

			{COMMAND_FOR_COLORCHANGE_CLICK_SIDE (_"Dark purple Saurian"){SCALE_SHIFT_DARKPURPLE}}
			
			{SCALE_OPTION (_ "Original List:") (_ "Original scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_GREEN}
			(changer_side)}
			
			{SCALE_OPTION (_ "More options:") (_ "Campaign Saurian scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_DEEP}
			(vpscale_side)}
			
			{SCALE_OPTION (_ "More options:") (_ "Spooky undead scales")
			("data/core/images/units/saurians/skirmisher/skirmisher.png~") {SCALE_SHIFT_PUMKIN}
			(undeadscale_side)}
			[option]
                label= _ "Back to the game"
				[clear_variable]
					name=saurian_location
				[/clear_variable]
            [/option]
        [/message]
	[/event]
#enddef

#define COLORCHANGE_CLICK
	[event] ### this event is for the case that all sides need to be changed
        name=start
        [if]
            [variable]
                name=scalechanger_ingame_allsides
                boolean_equals=yes
            [/variable]
			[then]
				[set_menu_item]
					id=colorchange_click
					description=_"Scale color changer"
					[show_if]
						{VARIABLE_CONDITIONAL scalechanger_ingame_allsides equals yes}
					[/show_if]
					[filter_location]
						[filter]
							race=lizard,black-marshes-saurians,bitter-swamp-lizard,thief-lizard
							x,y=$x1,$y1
						[/filter]
					[/filter_location]
					[command]
						[store_unit]
							variable=saurian_location
							[filter]
								x,y=$x1,$y1
							[/filter]
						[/store_unit]
						[fire_event]
							id=changer
						[/fire_event]
						[clear_variable]
							name=saurian_location
						[/clear_variable]
					[/command]
				[/set_menu_item]
			[/then]
            [elseif]
				[variable]
					name=scalechanger_ingame
					boolean_equals=yes
				[/variable]
				[then]
					[set_menu_item]
						id=colorchange_click
						description=_"Scale color changer"
						[show_if]
							{VARIABLE_CONDITIONAL scalechanger_ingame equals yes}
						[/show_if]
						[filter_location]
							[filter]
								side=$side_number
								race=lizard,black-marshes-saurians,bitter-swamp-lizard,thief-lizard
								x,y=$x1,$y1
							[/filter]
						[/filter_location]
						[command]
							[store_unit]
								variable=saurian_location
								[filter]
									x,y=$x1,$y1
								[/filter]
							[/store_unit]
							[fire_event]
								id=changer
							[/fire_event]
							[clear_variable]
								name=saurian_location
							[/clear_variable]
						[/command]
					[/set_menu_item]
				[/then]
			[/elseif]
		[/if]
	[/event]
	{COLORCHANGE_CLICK_EVENT}
#enddef

	#executing macros
	{SCALECHANGER_MASTER}
	{SCALECHANGER_MASTER_SIDE}
	{COLORCHANGE_CLICK}
	{SCALECHANGER_RECRUIT_SIDE_CHANGER}
	
[/modification]
